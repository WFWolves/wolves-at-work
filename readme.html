<h1>WF Wolves youBot stack Eindhoven 2013</h1>

<p>We used this ros stack to participate in the robocup@work world championship 2013.</p>

<h2>License</h2>

<p>We publish all of our code and documents under the <a href="https://creativecommons.org/licenses/by-nc-sa/3.0">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported (CC BY-NC-SA 3.0)</a>.
For commercial interest please contact us at <a href="http://robocup.fh-wolfenbuettel.de/index.php?option=com_content&amp;view=article&amp;id=57&amp;Itemid=63">wfwolves.de</a></p>

<h2>Dependencies</h2>

<p>The following package dependencies exist. We have used ROS Fuerte and the latest released version of the packages (last update was on 5th June 2013). Python 2.7 is required.</p>

<ul>
<li><a href="http://wiki.ros.org/smach">smach, smach_ros</a> -- <code>sudo apt-get install ros-fuerte-executive-smach</code> (https://github.com/ros/executive_smach)</li>
<li><a href="http://wiki.ros.org/geometry_msgs">geometry_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)</li>
<li><a href="http://wiki.ros.org/sensor_msgs">sensor_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)</li>
<li><a href="http://wiki.ros.org/rospy">rospy</a> -- <code>sudo apt-get install ros-fuerte-ros-comm</code> (https://github.com/ros/ros_comm)</li>
<li><a href="http://wiki.ros.org/tf">tf</a> -- <code>sudo apt-get install ros-fuerte-geometry</code> (https://kforge.ros.org/geometry/geometry)</li>
<li><a href="http://wiki.ros.org/rosgraph_msgs">rosgraph_msgs</a> -- <code>sudo apt-get install ros-fuerte-ros-comm</code> (https://github.com/ros/ros_comm)</li>
<li><a href="http://wiki.ros.org/brics_actuator">brics_actuator</a> -- <code>sudo apt-get install ros-fuerte-cob-common</code>(https://github.com/ipa320/cob_common)</li>
<li><a href="http://wiki.ros.org/std_msgs">std_msgs</a> -- <code>sudo apt-get install ros-fuerte-std-msgs</code>(https://github.com/ros/std_msgs)</li>
<li><a href="http://wiki.ros.org/actionlib">actionlib</a> -- <code>sudo apt-get install ros-fuerte-actionlib</code> (https://github.com/ros/actionlib)</li>
<li><a href="http://wiki.ros.org/control_msgs">control_msgs</a> -- <code>sudo apt-get install ros-fuerte-control</code> (https://bitbucket.org/sglaser/control)</li>
<li><a href="http://wiki.ros.org/kinematics_msgs">kinematics_msgs</a> -- <code>sudo apt-get install ros-fuerte-arm-navigation</code> (https://kforge.ros.org/armnavigation/armnavigation)</li>
<li><a href="http://wiki.ros.org/trajectory_msgs">trajectory_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)</li>
<li><a href="http://wiki.ros.org/arm_navigation_msgs">arm_navigation_msgs</a> -- <code>sudo apt-get install ros-fuerte-arm-navigation</code> (https://kforge.ros.org/armnavigation/armnavigation)</li>
<li><a href="http://wiki.ros.org/trajectory_msgs">trajectory_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)</li>
<li><a href="http://wiki.ros.org/image_transport">image_transport</a> -- <code>sudo apt-get install ros-fuerte-image-common</code> (https://github.com/ros-perception/image_common)</li>
<li><a href="http://wiki.ros.org/roscpp">roscpp</a> -- <code>sudo apt-get install ros-fuerte-ros-comm</code> (https://github.com/ros/ros_comm)</li>
<li><a href="http://wiki.ros.org/opencv2">opencv2</a> -- <code>sudo apt-get install ros-fuerte-opencv2</code> (http://opencv.org)</li>
<li><a href="http://wiki.ros.org/cv_bridge">cv_bridge</a> -- <code>sudo apt-get install ros-fuerte-vision-opencv</code> (https://github.com/ros-perception/vision_opencv)</li>
<li><a href="http://wiki.ros.org/image_geometry">image_geometry</a> -- <code>sudo apt-get install ros-fuerte-vision-opencv</code> (https://github.com/ros-perception/vision_opencv)</li>
<li><a href="http://wiki.ros.org/dynamic_reconfigure">dynamic_reconfigure</a> -- <code>sudo apt-get install ros-fuerte-dynamic-reconfigure</code> (https://github.com/ros/dynamic_reconfigure)</li>
<li><a href="http://wiki.ros.org/image_geometry">image_geometry</a> -- <code>sudo apt-get install ros-fuerte-vision-opencv</code> (https://github.com/ros-perception/vision_opencv)</li>
<li><a href="http://wiki.ros.org/nav_msgs">nav_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)</li>
<li><a href="http://wiki.ros.org/move_base">move_base</a> -- <code>sudo apt-get install ros-fuerte-navigation</code> (https://github.com/ros-planning/navigation)</li>
<li><a href="http://wiki.ros.org/actionlib_msgs">actionlib_msgs</a> -- <code>sudo apt-get install ros-fuerte-actionlib</code> (https://github.com/ros/actionlib)</li>
<li><a href="http://wiki.ros.org/pcl">pcl</a> -- <code>sudo apt-get install ros-fuerte-perception-pcl</code> (http://svn.pointclouds.org/ros/branches/fuerte/perception_pcl)</li>
<li><a href="http://wiki.ros.org/pcl_ros">pcl_ros</a> -- <code>sudo apt-get install ros-fuerte-perception-pcl</code> (http://svn.pointclouds.org/ros/branches/fuerte/perception_pcl)</li>
<li><a href="http://wiki.ros.org/laser_geometry">laser_geometry</a> -- <code>sudo apt-get install ros-fuerte-laser-pipeline</code> (https://github.com/ros-perception/laser_pipeline)</li>
<li><a href="http://wiki.ros.org/visualization_msgs">visualization_msgs</a> -- <code>sudo apt-get install ros-fuerte-common-msgs</code> (https://github.com/ros/common_msgs)/perception_pcl)</li>
<li><a href="http://www.youbot-store.com/youbot-developers/software/frameworks/ros-wrapper-for-kuka-youbot-api">youbot-ros-pkg</a> -- see website (https://github.com/youbot/youbot-ros-pkg)</li>
</ul>

<h2>Packages</h2>

<ul>
<li><b>youbot_main_ai:</b> <br />
The youbot_main_ai is our central robot behaviour which communicates with the referee-box and launches the necessary task-behaviour(besides conveyorbelt). The <code>main_ai.launch</code> file starts the smach-state-machine and tries to connect to the referee-box.</li>
<li><b>youbot_navigation_ai_re:</b> <br />
The youbot_navigation_ai_re is our robot behaviour for the navigation challenge and the <code>navigation_ai.launch</code> starts the smach-state-machine with a hard-coded Spec.</li>
<li><b>youbot_conveyorbelt_ai:</b> <br />
The youbot_conveyorbelt_ai is our robot behaviour for the conveyorbelt challenge and the <code>conveyorbelt_ai.launch</code> starts it with the connection to the referee-box. (this was implemented one hour befor the challenge)</li>
<li><b>youbot_manipulation_ai_re:</b> <br />
The youbot_manipulation_ai_re is our robot behaviour for the navigation challenge and the <code>manipulation_ai.launch</code> starts the smach-state-machine with a hard-coded Spec.</li>
<li><b>youbot_transportation_ai:</b> <br />
The youbot_transportation_ai_re is our robot behaviour for the navigation challenge and the <code>transportation_ai.launch</code> starts the smach-state-machine with no hard-coded Spec.</li>
<li><b>youbot_generic_scripts:</b> <br />
The youbot_generic_scripts is our general toolbox package.</li>
<li><b>youbot_ik_solution_modifier:</b> <br />
The youbot_ik_solution_modifier is an extension of our own IKControl class. We use it to handle the inverse kinematics from the youbot-ros-pkg. Due to quick fixing it is not in the youbot_manipulation_scripts package yet.</li>
<li><b>youbot_manipulation_scripts:</b> <br />
The youbot_manipulation_scripts is a toolbox for manipulation scripts and classes.</li>
<li><b>youbot_manipulation_vision:</b> <br />
The youbot_manipulation_vision is our object recognition node for the at-work objects. The <code>vision.launch</code> will start the node which tries to get a camera image on this topic: /usb_cam/image_raw.</li>
<li><b>youbot_scanner_alignment:</b> <br />
The youbot_scanner_alignment is a ROS service that lets the robot align itself to a wall in front of it. It needs the <code>detected_best_laser_line_filtered</code> topic (published by youbot_scanner_lines), this will be started within the main_ai-launch</li>
<li><b>youbot_scanner_lines:</b> <br />
The youbot_scanner_lines is a RANSAC linedetection on the range finder scans. For this it subscribes to the <code>/base_scan</code> topic which is our front laser range finder.</li>
</ul>

<h2>Files</h2>

<ul>
<li><b>ros-pkg.patch:</b> <br />
It is a patchfile for the youbot-ros-pkg to get our modificated launch files.</li>
<li><b>usb_cam_microsoft_hd.launch:</b> <br />
This is our camera launch file for the <a href="http://wiki.ros.org/usb_cam">usb_cam</a> node</li>
<li><b>move_base_global_dwa.launch:</b> <br />
Our try to use the dwa planner.</li>
<li><b>base_back_hokuyo_node.launch:</b> <br />
We have two laser_range finders mounted on our robot, so this .launch is for the one in the back.</li>
</ul>

<h2>Installation</h2>

<p>When the youBot is fresh installed you can patch the youbot-ros-pkg to get our modificated .launch files. To patch just copy the <code>ros-pkg.patch</code> file into your youbot-ros-pkg folder and execute the folowing in it:</p>

<pre><code>patch -p 3 &lt; ./ros-pkg.patch
</code></pre>

<p>After that there are new .launch files which have to be moved into the corresponding folders</p>

<ul>
<li><code>base_back_hokuyo_node.launch</code> into the <code>youbot-ros-pkg/youbot_navigation/youbot_navigation_common/launch</code> folder</li>
<li><code>move_base_global_dwa.launch</code> into the <code>youbot-ros-pkg/youbot_navigation/youbot_navigation_global/launch</code> folder</li>
<li><code>usb_cam_microsoft_hd.launch</code> into the <code>usb_cam/launch</code> folder</li>
</ul>

<p>To be sure that all of our own ros_msgs are generated, build all packages:</p>

<pre><code>rosmake youbot_scanner_lines youbot_manipulation_vision youbot_conveyorbelt_ai youbot_ik_solution_modifier youbot_main_ai youbot_manipulation_scripts youbot_navigation_ai_re youbot_scanner_alignment youbot_transportation_ai
</code></pre>

<h2>Usage</h2>

<p>To use our stuff you need to start some basic nodes:</p>

<pre><code>roslaunch youbot_manipulation_examples bringup.launch
roslaunch youbot_navigation_common base_front_hokuyo_node.launch
roslaunch youbot_navigation_common base_back_hokuyo_node.launch
roslaunch usb_cam usb_cam_microsoft_hd.launch
roslaunch youbot_manipulation_vision vision.launch
roslaunch youbot_navigation_global amcl.launch
roslaunch youbot_navigation_global move_base_global_dwa.launch
</code></pre>

<p>After this you have to make sure that the robot is localised and don't forget to calibrate the vision. For vision calibration you can use dynamic_reconfigure.
Now your robot preperation is finished and you can connect to the referee-box and start the challenge with:</p>

<pre><code>roslaunch youbot_main_ai main_ai.launch
</code></pre>

<p>Now cross your fingers as we do it all the time.</p>

<h2>Troubleshooting</h2>

<p>If you have any questions or problems regarding robot setup or installation, feel free to contact us at <a href="http://robocup.fh-wolfenbuettel.de/index.php?option=com_content&amp;view=article&amp;id=57&amp;Itemid=63">wfwolves.de</a>.</p>

<h2>Contributing</h2>

<ol>
<li>Fork it.</li>
<li>Create a branch (<code>git checkout -b my_youbot_ai</code>)</li>
<li>Commit your changes (<code>git commit -am "Added Snarkdown"</code>)</li>
<li>Push to the branch (<code>git push origin my_youbot_ai</code>)</li>
<li>Open a [Pull Request][1]</li>
<li>Enjoy a refreshing Diet Coke and wait</li>
</ol>
